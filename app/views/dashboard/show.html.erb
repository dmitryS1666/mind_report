<div class="mx-auto max-w-6xl">
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ + –º–æ–¥–∞–ª–∫–∞ –∂–∏–≤—É—Ç –≤ –æ–¥–Ω–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ -->
  <div class="mb-4 flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-semibold text-slate-900">–ù–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑</h1>
      <p class="text-slate-600 text-sm">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞—É–¥–∏–æ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–º–æ-–∞–Ω–∞–ª–∏–∑.</p>
    </div>

    <!-- —Å–ø—Ä–∞–≤–∞ -->
    <button type="button"
            class="inline-flex items-center gap-2 px-3 py-2 text-sm rounded-lg border border-slate-300 hover:bg-slate-50"
            data-action="click->modal#open">
      üìú –ò—Å—Ç–æ—Ä–∏—è
    </button>
  </div>

  <div class="grid grid-cols-12 gap-4">
    <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨: ¬´–ß–∞—Ç¬ª -->
    <section class="col-span-12">
      <div id="chat"
           class="bg-white border border-slate-200 rounded-xl p-4 space-y-4
                  max-h-[calc(100vh-220px)] overflow-y-auto">

        <!-- —Ç—É–ª–±–∞—Ä -->
        <div class="flex items-center justify-between">
          <div class="text-sm text-slate-600">–õ–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π</div>
          <div class="flex items-center gap-2">
            <!-- –û—á–∏—Å—Ç–∏—Ç—å –ª–µ–Ω—Ç—É (UI) -->
            <button type="button"
                    class="text-xs p-3 px-2 py-1 rounded-md border border-slate-300 hover:bg-slate-50"
                    onclick="(function(){
                      const a=document.getElementById('analysis_panels');
                      const s=document.getElementById('analysis_stream_target');
                      if(a)a.innerHTML='';if(s)s.innerHTML='';}
                    )()">
              –û—á–∏—Å—Ç–∏—Ç—å –ª–µ–Ω—Ç—É
            </button>
          </div>
        </div>

        <!-- –æ–±—â–∏–π —Å—Ç—Ä–∏–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
        <%= turbo_stream_from "analyses_stream_user_#{current_user.id}" %>
        <div id="analysis_stream_target" class="space-y-3"></div>

        <!-- –ø–∞–Ω–µ–ª–∏ —Ç–µ–∫—É—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ -->
        <div id="analysis_panels"></div>
      </div>

      <!-- –õ–∏–ø–∫–∞—è —Ñ–æ—Ä–º–∞ -->
      <div class="sticky bottom-4 mt-4">
        <div class="bg-white border border-slate-200 rounded-xl p-3 shadow-sm">
          <%= form_with url: demo_analyses_path,
                        method: :post,
                        data: { turbo_stream: true },
                        html: { class: "flex items-center gap-3", enctype: "multipart/form-data" } do |f| %>

            <%= f.file_field :file, required: true,
                  accept: "audio/*,text/plain,.txt,.md",
                  class: "block w-full text-sm text-slate-600
                          file:mr-3 file:py-2 file:px-3 file:rounded-lg file:border-0
                          file:text-sm file:font-semibold
                          file:bg-slate-900 file:text-white
                          hover:file:bg-slate-800" %>

            <span class="hidden md:block text-xs text-slate-500 whitespace-nowrap">
              –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∞—É–¥–∏–æ (mp3/m4a/wav –∏ –¥—Ä.) –∏ —Ç–µ–∫—Å—Ç (txt/md).
            </span>

            <%= f.submit "–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–æ-–∞–Ω–∞–ª–∏–∑",
                  class: "px-4 py-2 rounded-lg bg-emerald-600 text-white text-sm font-semibold hover:bg-emerald-700" %>
          <% end %>
        </div>
      </div>
    </section>
  </div>
</div>
